q()
q()
cd("soilMoisture")
source("soilMoisture.R")
getwd()
setwd("soilMoisture")
source("soilMoisture.R")
source("quickLook.R")
dim(tbl)
head(tbl)
write.table(tbl, "~/stage/soilMoisture.tsv", sep="\t", quote=FALSE, row.names=FALSE, col.names=TRUE)
q()
q()
list.files()
q()
source("combine.R")
getwd()
q()
q()
q()
biocGet("DescTools")
n
library(DescTools)
DrawEllipse(x = 0, y = x, radius.x = 1, radius.y = 0.5, rot = 0,
            nv = 100, border = par("fg"), col = par("bg"),
            lty = par("lty"), lwd = par("lwd"), plot = TRUE)
x = 0
DrawEllipse(x = 0, y = x, radius.x = 1, radius.y = 0.5, rot = 0,
            nv = 100, border = par("fg"), col = par("bg"),
            lty = par("lty"), lwd = par("lwd"), plot = TRUE)
plot.new()
DrawEllipse(x = 0, y = x, radius.x = 1, radius.y = 0.5, rot = 0,
            nv = 100, border = par("fg"), col = par("bg"),
            lty = par("lty"), lwd = par("lwd"), plot = TRUE)
?plot.new
DrawEllipse(x = 0, y = x, radius.x = 1, radius.y = 0.5, rot = 0,
            nv = 100, border = par("fg"), col = par("bg"),
            lty = par("lty"), lwd = par("lwd"), plot = FALSE)
?DrawEllipse
print(DrawEllipse(x = 0, y = x, radius.x = 1, radius.y = 0.5, rot = 0,
            nv = 100, border = par("fg"), col = par("bg"),
            lty = par("lty"), lwd = par("lwd"), plot = FALSE))
print(DrawEllipse(x = 0, y = x, radius.x = 1, radius.y = 0.5, rot = 0,
            nv = 100, border = par("fg"), col = par("bg"),
            lty = par("lty"), lwd = par("lwd"), plot = FALSE))
points <- DrawEllipse(x = center.x, y = center.y,
                      radius.x = r.x, radius.y = r.y, rot = rotation,
                      nv = 10, border = par("fg"), col = par("bg"),
                      lty = par("lty"), lwd = par("lwd"), plot = FALSE)


head(points$x)
head(points$y)
getwd()
setwd("/Users/paul/github/sewardParkRestoration/hemlockSurvey2024/incoming/googleMapsTables")
biocGet("rgdal")
n
biocget("pgirmess")
biocGet("pgirmess")
n
library("pgirmess")
writeOGR
install.packages("rgdal")
install.packages(c("gpx"), repos="http://cran.fhcrc.org")
library(gpx)
46.5 * 5280
69 * 5280
points.x
points$x
wdth(300)
points$x
points$y
?DrawEllipse
q()
read.table("trees.csv", sep=",", header=TRUE, as.is=TRUE)
setwd("maps/muweiAndEric")
q()
q()
q()
source("prepTreePoints.R")
q()
f <- "https://pshannon.net/hemlockSurvey2024/tblFinal.csv"
tbl <- read.table(f, sep=",", header=TRUE, as.is=TRUE, nrow=-1)
f <- "https://pshannon.net/hemlockSurvey2024/tblFinal.csv"
tbl <- read.table(f, sep=",", header=TRUE, as.is=TRUE, nrow=-1)
dim(tbl)
read.table(f, sep=",", header=TRUE, as.is=TRUE, nrow=-1)
wdth(3000)
read.table(f, sep=",", header=TRUE, as.is=TRUE, nrow=-1)
dim(tbl)
dim(tbl)
colnames(tbl)
mapMidpoint  <- 47.556575
dim(subset(tbl, lat >= 47.556575))
dim(subset(tbl, lat >= mapMindpoint))
dim(subset(tbl, lat >= mapMidpoint))
subset(tbl, lat >= mapMidpoint)
subset(tbl, lat >= mapMidpoint)$h
mean(subset(tbl, lat >= mapMidpoint)$h)
mean(subset(tbl, lat > mapMidpoint)$h)
mean(subset(tbl, lat < mapMidpoint)$h)
mean(subset(tbl, lat < mapMidpoint)$h, na.rm=TRUE)
median(subset(tbl, lat < mapMidpoint)$h)
median(subset(tbl, lat < mapMidpoint)$h, na.rm=TRUE)
median(subset(tbl, lat > mapMidpoint)$h, na.rm=TRUE)
tbl.north <- subset(tbl, lat >= mapMidpoint)
tbl.south <- subset(tbl, lat < mapMidpoint)

dim(tbl.north)
dim(tbl.south)
t.test(tbl.north$h, tbl.south$h)
dim(subset(tbl, is.na(h)))
t(subset(tbl, is.na(h)))
boxplot(tbl.north$h, tbl.south$h, names=c("graveyard", "garden"), main="Hemlock Health scaled 0-3")
boxplot(tbl.north$dbh, tbl.south$dbh, names=c("graveyard", "garden"), main="Hemlock Health scaled 0-3")
plot(x=tbl$dbh, y=tbl$h)
cor(x=tbl$dbh, y=tbl$h)
cor(x=tbl$dbh, y=tbl$h, na.rm=TRUE)
cor(tbl$dbh, tbl$h)
tbl.clean <- subset(tbl, !is.na(dbh) & !is.na(h))
cor(tbl.clean$h, tbl.clean$dbh)
cor(tbl.clean$h, tbl.clean$dbh)
tbl.clean <- subset(tbl, !is.na(dbh) & !is.na(h))
tbl.north.small <- subset(tbl, dbh < 15.5 & lat >= mapMidpoint)
dim(tbl.north.small)
tbl.south.small <- subset(tbl, dbh < 15.5 & lat < mapMidpoint)
dim(tbl.south.small)
t.test(tbl.south.small$h, tbl.north.small$h)
q()
read.table("hemlocks.tsv", sep="\t", header=TRUE, as.is=TRUE, nrow=3)
setwd("hemlockSurvey2021")
read.table("hemlocks.tsv", sep="\t", header=TRUE, as.is=TRUE, nrow=3)
wdth(200)
read.table("hemlocks.tsv", sep="\t", header=TRUE, as.is=TRUE, nrow=3)
tbl <- read.table("hemlocks.tsv", sep="\t", header=TRUE, as.is=TRUE, nrow=-1)
dim(tbl)
write.table("../hemlockSurvey2024/maps/muweiAndEric/hemlocks-2021.csv", sep=",", quote=FALSE, row.names=FALSE)
write.table(tbl, "../hemlockSurvey2024/maps/muweiAndEric/hemlocks-2021.csv", sep=",", quote=FALSE, row.names=FALSE)
head(tbl[, c("id", "lat", "lon", "dbh", "dmr1", "dmr2", "dmr3","date")])
tbl.out <- tbl[, c("id", "lat", "lon", "dbh", "dmr1", "dmr2", "dmr3","date")]
head(tbl.out)
tbl$dmr1
3 - tbl$dmr1
tbl$dmr1 <- 3 - tbl$dmr1
tbl$dmr2 <- 3 - tbl$dmr2
tbl$dmr3 <- 3 - tbl$dmr3
write.table(tbl, "../hemlockSurvey2024/maps/muweiAndEric/hemlocks-2021.csv", sep=",", quote=FALSE, row.names=FALSE)
tbl.out <- tbl[, c("id", "lat", "lon", "dbh", "dmr1", "dmr2", "dmr3","date", "notes", "observer")]
head(tbl.out)
colnames(tbl)
tbl.out$notes
tbl.out$dmr1 <- 3 - tbl.out$dmr1
tbl.out$dmr2 <- 3 - tbl.out$dmr2
tbl.out$dmr3 <- 3 - tbl.out$dmr3
head(tbl.out
)
tbl.out
wdth(320)
tbl.out
wdth(1200)
tbl.out
tbl
tbl <- read.table("hemlocks.tsv", sep="\t", header=TRUE, as.is=TRUE, nrow=-1, quote=NA)
tbl <- read.table("hemlocks.tsv", sep="\t", header=TRUE, as.is=TRUE, nrow=-1, quote=NULL)
tbl
tbl.out <- tbl[, c("id", "lat", "lon", "dbh", "dmr1", "dmr2", "dmr3","date", "notes", "observer")]
tbl.out
tbl.out$dmr1 <- 3 - tbl.out$dmr1
tbl.out$dmr2 <- 3 - tbl.out$dmr2
tbl.out$dmr3 <- 3 - tbl.out$dmr3
subset(tbl.out, dmr3==3)
subset(tbl.out, dmr3==0)
subset(tbl.out, dmr3==1)
tbl.out$drm1
tbl.out$dmr1
tbl
q()
getwd()
 q()
q()
f <- "https://pshannon.net/hemlockSurvey2024/tblFinal.csv"
tbl <- read.table(f, sep=",", header=TRUE, as.is=TRUE, nrow=-1, quote="")
dim(tbl)

colnames(tbl)
cor(tbl$wpDamage, tbl$dbh)
cor(tbl$wpDamage, tbl$h)
?cor
cor(tbl$wpDamage, tbl$h, use="pairwise.complete.obs")
lm(wpDamage ~ 0 + h + dbh)
lm(wpDamage ~ 0 + h + dbh, data=tbl)
model <- lm(wpDamage ~ 0 + h + dbh, data=tbl)
summary(model)
abline(model)
plot(model)
predict(model)
plot(predict(model))
abline(model)
model <- lm(wpDamage ~ 0 + h * dbh, data=tbl)
summary(model)
with(subset(tbl, wpDamage > 0), plot(wpDamage, dbh))
with(subset(tbl, wpDamage > 0), plot(dbh, wpDamage))
with(subset(tbl, wpDamage > 0), plot(dbh * h, wpDamage))
 coef(model)
model <- lm(wpDamage ~ 0 + h + dbh, data=tbl)
coef(model)
resid(model)
hist(resid(model))
model <- lm(wpDamage ~ *, data=tbl)
model <- lm(wpDamage ~ ., data=tbl)
summary(model)
colnames(tbl)
model <- lm(wpDamage ~ h + canopy + dfAssoc + aspect + slope + h, data=tbl)
summary(model)
model <- lm(wpDamage ~ h + canopy + dfAssoc + aspect + slope + h + dbh, data=tbl)
summary(model)
library(secr)
biocGet("secr")
n
xy <- matrix(runif(200, -0.5, 1.5), ncol = 2)
poly <- data.frame(x = c(1, 1, 0, 0, 1), y = c(1,0,0, 1, 1))
poly
plot(xy, pch = 1 + pointsInPolygon(xy, poly))
library(secr)
plot(xy, pch = 1 + pointsInPolygon(xy, poly))
lines(poly)
tbl.sick <- subset(tbl, h<=1)
cellCount <- 500
osm.limits <- c(-122.25676, -122.248006, 47.548233, 47.562744) # open street map
limits <- osm.limits

limits <- c(-122.25676, -122.248006, 47.548233, 47.562744) # open street map
f.sick <- kde2d(tbl.sick$lon, tbl.sick$lat, n=cellCount, lims=limits)
library(MASS)
f.sick <- kde2d(tbl.sick$lon, tbl.sick$lat, n=cellCount, lims=limits)
f.graveyard <- kde2d(tbl.sick$lon, tbl.sick$lat, n=cellCount, lims=limits)
boundaries.graveyard <- contourLines(f.graveyard)

length(boundaries.graveyard)
tbl.graveyard <- data.frame(x=boundaries.graveyard$x, y=boundaries.graveyard$y)
dim(tbl.graveyard)
tbl.graveyard <- data.frame(x=boundaries.graveyard[6]$x, y=boundaries.graveyard[6]$y)
dim(tbl.graveyard)
names(boundaries.graveyard)
boundaries.graveyard <- contourLines(f.graveyard)
boundaries.graveyear
names(boundaries.graveyard)
boundaries.graveyard
boundaries.graveyard[[1]]
boundaries.graveyard[[1]]$x
tbl.graveyard <- data.frame(x=boundaries.graveyard[[6]]$x, y=boundaries.graveyard[[6]]$y)
dim(tbl.graveyard)
head(tbl.graveyard)
poly
dim(xy)
length(pointsInPolygon(tbl[, c("lat", "lon")], tbl.graveyard))
head(pointsInPolygon(tbl[, c("lat", "lon")], tbl.graveyard))
length(which(pointsInPolygon(tbl[, c("lat", "lon")], tbl.graveyard)))
head(tbl.graveyard)
head(tbl[, c("lat", "long")])
head(tbl[, c("lat", "lon")])
length(which(pointsInPolygon(tbl[, c("lon", "lat")], tbl.graveyard)))
head(which(pointsInPolygon(tbl[, c("lon", "lat")], tbl.graveyard)))
tbl[80,]
length(boundaries.graveyard)
for(b in boundaries.graveyards) print(length(b$x))
for(b in boundaries.graveyard) print(length(b$x))
contours(f.graveyard)
contour(f.graveyard)
graveyard.poly.6 <- data.frame(x=boundaries.graveyard[[6]]$x, y=boundaries.graveyard[[6]]$y)
head(graveyard.poly.6)

length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly.6)))
dim(tbl)
contour.number <- 14
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,

graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)

dim(graveyard.poly)
length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly)))
contour.number <- 11
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)
head(graveyard.poly)

# how many points are in this region? 214 of the 724 
length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly)))

contour.number <- 15 
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)
head(graveyard.poly)

# how many points are in this region? 214 of the 724 
length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly)))

contour.number <- 6
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)
head(graveyard.poly)

# how many points are in this region? 214 of the 724 
length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly)))

contour.number <- 6
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)
head(graveyard.poly)

tbl.rows.in.boundary <- which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))
print(length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))))

contour.number <- 10
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)
head(graveyard.poly)

# how many points are in this region? 214 of the 724 
tbl.rows.in.boundary <- which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))
print(length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))))

graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)
head(graveyard.poly)

# how many points are in this region? 214 of the 724 
tbl.rows.in.boundary <- which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))
print(length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))))
# which tbl rows describe trees in this graveyard region?
tbl.sub <- tbl[tbl.rows.in.boundary,]

dim(tbl.sub)
cor(tbl.sub$wpDamage, tbl.sub$dbh)
cor(tbl$wpDamage, tbl$dbh)
cor(tbl.sub$wpDamage, tbl.sub$h, use="pairwise.complete.obs")
cor(tbl$wpDamage, tbl$h, use="pairwise.complete.obs")
contour.number <- 14
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)
head(graveyard.poly)

# how many points are in this region? 214 of the 724 
tbl.rows.in.boundary <- which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))
print(length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))))
# which tbl rows describe trees in this graveyard region?
tbl.sub <- tbl[tbl.rows.in.boundary,]

### Calculate the same correlations seen above: do dbh and health in the graveyard
# correlate better than across the entire dataset?

cor(tbl.sub$wpDamage, tbl.sub$dbh)
cor(tbl.sub$wpDamage, tbl.sub$h, use="pairwise.complete.obs")

cor(tbl.sub$wpDamage, tbl.sub$dbh)
contour.number <- 11
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)
head(graveyard.poly)

# how many points are in this region? 214 of the 724 
tbl.rows.in.boundary <- which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))
print(length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))))
# which tbl rows describe trees in this graveyard region?
tbl.sub <- tbl[tbl.rows.in.boundary,]

### Calculate the same correlations seen above: do dbh and health in the graveyard
# correlate better than across the entire dataset?

cor(tbl.sub$wpDamage, tbl.sub$dbh)
cor(tbl.sub$wpDamage, tbl.sub$h, use="pairwise.complete.obs")

contour.number <- 11
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)

tbl.rows.in.boundary <- which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))
print(length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))))

tbl.sub <- tbl[tbl.rows.in.boundary,]

cor(tbl.sub$wpDamage, tbl.sub$dbh)
cor(tbl.sub$wpDamage, tbl.sub$h, use="pairwise.complete.obs")

contour.number <- 10
graveyard.poly <- data.frame(x=boundaries.graveyard[[contour.number]]$x,
                               y=boundaries.graveyard[[contour.number]]$y)

tbl.rows.in.boundary <- which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))
print(length(which(pointsInPolygon(tbl[, c("lon", "lat")], graveyard.poly))))

tbl.sub <- tbl[tbl.rows.in.boundary,]

cor(tbl.sub$wpDamage, tbl.sub$dbh)
cor(tbl.sub$wpDamage, tbl.sub$h, use="pairwise.complete.obs")
model <- lm(wpDamage ~ 0 + h + dbh, data=tbl.sub)
summary(model)
dim(tbl)
q()
